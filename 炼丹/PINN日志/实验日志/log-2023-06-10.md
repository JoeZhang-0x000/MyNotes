## 实验安排
### 实验流程
#### 框架部分
1. 在pde模块中增加一个新的控制方程，为Helmholtz方程。
2. 更改flow类
#### 参数部分
##### helmholtz方程
$$
\begin{aligned}
& -u_{xx} - u_{yy} - k^2u =  f,\Omega=[0,1]^2 \\
& u(x,y) = 0, (x,y)\in \partial\Omega \\
& f=2\pi n \\
& n = 2
\end{aligned}
$$
##### 解析解
$$
\begin{aligned}
u(x,y) = sin(kx)sin(ky)
\end{aligned}
$$
#### 参数设定
按LuLu deepxde设置，
```python
data = dde.data.PDE(geom, pde, bc, num_domain=1200, num_boundary=120, num_test=1500)
```
即，内部点设定1200个，边界上120个，
网络为
```python
net = dde.nn.FNN([2] + [50] * 4 + [1], "tanh", "Glorot uniform")
```
即2，50，50，50，50，1
优化器为adam,学习率为1e-3，
迭代训练5000次.
## 实验结果

|-|全固定-0|只固定边界-2|只固定内部-3|全不固定-1|
|-|-|-|-|-|
|耗时|11371.17|11092.16|8057.62|7470.99|
|R2截断|-4.01e+06|-1.83e+08|-5.53e+05|-2.92e+07|
## 结果分析
### 耗时
从耗时来看，逐渐增加采样点的方案是可以有效缩短训练时间的，在本问题中，边界点的采样数量每次增加了480/10个，而内部点的采样点每次增加了1200/10个，采样的时间忽略不计，则对应的训练点的数量应当为
1200+480,120(x//500+1)+480,1200+48(x//500+1),120(x//500+1)+48(x//500+1)
![[Pasted image 20230610203238.png|300]]
对应着训练所花时间应当是0,3,2,1的顺序，可是与观测到的结果0，2，3，1并不相符。也就是说，训练边界点居然更花费时间。不明白为什么。可能是代码的问题吗？
或者是部分因为开4个进程让cpu满载了，导致测量的时间并不准确。
附该服务器的cpu型号截图。
![[Pasted image 20230610204451.png|400]]
### 精度
精度并不理想，lulu的源码中仅仅使用了5k步，`2,150,150,150,1`的网络即可取得良好的结果，我使用的是`[2,64,64,64,64,1]`的网络，虽然Lu使用了硬边界，但是就算不施加硬边界也不应该有这么大的差距。眼下最迫切的是找到代码的问题，为什么精度如此差。